# ==============================================================================
# EduSynapseOS Environment Configuration
# ==============================================================================
# Copyright (C) 2025 Global Digital Labs (gdlabs.io)
# SPDX-License-Identifier: LGPL-3.0-or-later
#
# Copy this file to .env and update values for your environment.
#
# Architecture:
#   - Central Database: Platform management (tenants, system users, licenses)
#   - Tenant Databases: One PostgreSQL container per tenant (created dynamically)
#   - Shared Services: Redis, Qdrant with tenant isolation via namespacing
#
# Port Ranges:
#   - Main services: 34000-35000
#   - Tenant PostgreSQL: 44000-45000
# ==============================================================================

# ==============================================================================
# Environment
# ==============================================================================
ENVIRONMENT=development
DEBUG=true
LOG_LEVEL=DEBUG

# ==============================================================================
# Central PostgreSQL Database
# ==============================================================================
# The central database stores platform-level data:
# - Tenants, system users, licenses, feature flags
CENTRAL_DB_USER=edusynapse
CENTRAL_DB_PASSWORD=edusynapse_central_password
CENTRAL_DB_HOST=localhost
CENTRAL_DB_PORT=34001

# Application central database URL (for local development without Docker)
CENTRAL_DATABASE_URL=postgresql+asyncpg://edusynapse:edusynapse_central_password@localhost:34001/edusynapse_central

# ==============================================================================
# Tenant PostgreSQL Configuration
# ==============================================================================
# Each tenant gets a separate PostgreSQL container.
# These credentials are used when creating new tenant containers.
TENANT_DB_USER=edusynapse
TENANT_DB_PASSWORD=edusynapse_tenant_password

# Tenant container naming pattern: edusynapse-tenant-{code}-db
# Port range for tenant databases (auto-assigned starting from this port)
# Range: 44000-45000
TENANT_DB_PORT_RANGE_START=44000

# Host path to tenant database initialization script
# This is the path ON THE HOST machine (not inside containers)
# Used by Docker SDK when creating tenant containers
TENANT_INIT_SCRIPT_HOST_PATH=/path/to/project/scripts/init-tenant-db.sql

# ==============================================================================
# Redis
# ==============================================================================
# Tenant isolation via key prefix: tenant:{tenant_code}:*
REDIS_PASSWORD=edusynapse_redis_password
REDIS_HOST=localhost
REDIS_PORT=34002

# Application Redis URL (for local development without Docker)
REDIS_URL=redis://:edusynapse_redis_password@localhost:34002/0

# ==============================================================================
# Qdrant Vector Database
# ==============================================================================
# Tenant isolation via collection naming: tenant_{tenant_code}_{collection}
QDRANT_HOST=localhost
QDRANT_HTTP_PORT=34003
QDRANT_GRPC_PORT=34004
QDRANT_API_KEY=

# Application Qdrant URL (for local development without Docker)
QDRANT_URL=http://localhost:34003

# ==============================================================================
# API Server
# ==============================================================================
API_PORT=34000
API_WORKERS=2

# ==============================================================================
# Background Worker
# ==============================================================================
WORKER_PROCESSES=2
WORKER_THREADS=4

# ==============================================================================
# MCP Server (Optional)
# ==============================================================================
MCP_PORT=34005

# ==============================================================================
# JWT Authentication
# ==============================================================================
# Generate secret: python -c "import secrets; print(secrets.token_urlsafe(32))"
JWT_SECRET_KEY=change-this-in-production
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# ==============================================================================
# LLM Configuration
# ==============================================================================
# Default provider: ollama, openai, anthropic, google
DEFAULT_LLM_PROVIDER=ollama

# Ollama (Local or Remote)
# For local Ollama: http://localhost:11434 or http://host.docker.internal:11434 (Docker)
# For Vast.ai or other remote GPU instances: http://YOUR_IP:PORT
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_API_KEY=
OLLAMA_DEFAULT_MODEL=qwen2.5:7b

# OpenAI
OPENAI_API_KEY=
OPENAI_DEFAULT_MODEL=gpt-4o

# Anthropic
ANTHROPIC_API_KEY=
ANTHROPIC_DEFAULT_MODEL=claude-3-5-sonnet-20241022

# Google
GOOGLE_API_KEY=
GOOGLE_DEFAULT_MODEL=gemini-2.0-flash-exp

# ==============================================================================
# Embedding Model
# ==============================================================================
EMBEDDING_MODEL=paraphrase-multilingual-MiniLM-L12-v2
EMBEDDING_DIMENSION=384

# ==============================================================================
# Rate Limiting
# ==============================================================================
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST=10

# ==============================================================================
# CORS
# ==============================================================================
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
CORS_ALLOW_CREDENTIALS=true

# ==============================================================================
# OpenTelemetry (Optional)
# ==============================================================================
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_SERVICE_NAME=edusynapseos
OTEL_ENABLED=false

# ==============================================================================
# Game Engine Service
# ==============================================================================
# External game engine service providing professional-level AI for board games
# (Chess, Gomoku, Othello, Checkers, Connect4)
GAME_ENGINE_HOST=localhost
GAME_ENGINE_PORT=34500
GAME_ENGINE_TIMEOUT=30.0
GAME_ENGINE_ENABLED=true

# ==============================================================================
# Central Curriculum Service
# ==============================================================================
# Central Curriculum API provides curriculum data (frameworks, stages, grades,
# subjects, units, topics, learning objectives). Data is synced to local database.
CENTRAL_CURRICULUM_BASE_URL=https://curriculum.edusynapse.com/api/v1
CENTRAL_CURRICULUM_API_KEY=your_api_key_here
CENTRAL_CURRICULUM_API_SECRET=your_api_secret_here
CENTRAL_CURRICULUM_TIMEOUT=60.0
CENTRAL_CURRICULUM_SYNC_ENABLED=true
CENTRAL_CURRICULUM_SYNC_INTERVAL_HOURS=24
CENTRAL_CURRICULUM_TRUSTED_SYSTEM_SECRET=your_trusted_system_secret_here

# ==============================================================================
# H5P Server (Optional - for interactive content)
# ==============================================================================
H5P_SERVER_URL=http://localhost:17000
H5P_API_KEY=your_h5p_api_key_here
